title: Exploit for XSS, XSRF/CSRF, and XXE
status: experimental
description: Detects requests with signs of an XSS, XSRF/CSRF, or XXE exploit
references:
    - https://owasp.org/www-community/attacks/xss/
    - https://owasp.org/www-community/attacks/csrf/
    - https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing
author: Your Name
date: 2022/02/22
logsource:
    category: webserver
    type: httpd_access
detection:
    selection:
        'GET /': # Change this to the specific endpoint(s) to monitor
            condition: "'<script>' in http_user_agent or 'csrf_token' in http_cookie or '<!ENTITY' in http_user_agent"
    condition: selection
falsepositives:
    - Legitimate requests that contain the string '<script>' or '<!ENTITY' in the user agent header or cookies
    - POST requests that contain the string 'csrf_token' in the HTTP cookie (if this is a valid anti-CSRF token)
level: critical
