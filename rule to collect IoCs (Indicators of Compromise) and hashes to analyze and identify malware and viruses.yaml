rule collect_hashes_and_iocs
{
    meta:
        description = "Collect hashes and IoCs from a file"

    strings:
        $md5_hash = {4 byte hex string}
        $sha1_hash = {5 byte hex string}
        $sha256_hash = {8 byte hex string}
        $url = /https?:\/\/[\S]+/
        $ip_address = /\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/
        $domain = /[a-zA-Z0-9-]+\.[a-zA-Z]{2,}/
        $registry_key = /[a-zA-Z0-9_-]+\\[a-zA-Z0-9_.-]+/

    condition:
        any of ($md5_hash, $sha1_hash, $sha256_hash, $url, $ip_address, $domain, $registry_key)
}
